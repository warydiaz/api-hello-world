name: Java CI


on:
 pull_request:
   branches:
     - main
     - develop
 push:
   branches-ignore:
     - '**' # Ignore push events to all branches, as pull_request handles testing


jobs:
 build:
   runs-on: ubuntu-latest


   steps:
     # 1. Checkout the repository
     - name: Checkout code
       uses: actions/checkout@v3


     # 2. Set up Java
     - name: Set up JDK
       uses: actions/setup-java@v3
       with:
         distribution: 'temurin'
         java-version: '17'


     # 3. Install dependencies
     - name: Build with Maven
       run: mvn clean install


     # 4. Run tests
     - name: Run tests for PR to main or develop
       if: github.event_name == 'pull_request' && (github.base_ref == 'main' || github.base_ref == 'develop')
       run: mvn test  # Run all tests


     - name: Run tests for other branches
       if: github.event_name != 'pull_request' && startsWith(github.ref, 'refs/heads/')
       run: mvn test -Dtest=**/*Test.java  # Run only tests ending with 'Test.java'